{"report": "# Analysis of the routing paths of the Dreammaker‑legal‑agent project\n\nThis project is a **Node.js/Express server** that uses the `server.ts` file in the `src` folder as its entry point. Many internal services such as **artificial intelligence, market analysis, trading management and system configuration** are implemented as separate controllers. The `server.ts` file instantiates these controllers and then defines HTTP routing for each section.\n\n## Overall structure\n\n* **Environment loading and configuration:** At the beginning of `server.ts` the environment variables are loaded and required services (database, cache, data analysis services etc.) are initialized. Then an Express instance is created and middleware such as logging and CORS handling are added.\n\n* **Central routing in `server.ts`:** The `server.ts` file defines almost all HTTP routes using calls like `app.get(...)` and `app.post(...)` and for each route the corresponding controller method is called. Only one separate routing (`/api/config`) is imported from a separate file (`routes/dataSource.ts`). This makes all routing visible in a single location.\n\n## DataSource routing\n\nThe file `src/routes/dataSource.ts` defines an Express Router that provides two routes. This Router is mounted in `server.ts` with the `/api/config` prefix; therefore the final paths are as follows:\n\n| Path (Method) | Description & controller |\n| --- | --- |\n| **`GET /api/config/data‑source`** | Uses `DataSourceController` to return the current primary data source and available sources【858205439123634†L819-L823】. |\n| **`POST /api/config/data‑source`** | A POST request to the same path changes the primary data source using the `setPrimarySource` method of `DataSourceController`【739300074041999†L7-L9】. |\n\n## AI endpoints (`/api/ai`)\n\nThe AI section has many operations and uses the `AIController` and training engines. Key routes include:\n\n| Path (Method) | Description / operation |\n| --- | --- |\n| `GET /api/ai/test‑initialization` | Uses the `XavierInitializer` class to create initial network weights and returns their shape【858205439123634†L1360-L1368】. |\n| `GET /api/ai/test‑activations` | Tests the stability of activation functions and returns the result【858205439123634†L1300-L1330】. |\n| `POST /api/ai/create‑network` | Creates a neural network according to the architecture (LSTM/CNN/Attention/Hybrid) and initializes the weights【858205439123634†L1314-L1355】. |\n| `POST /api/ai/train‑step` and `POST /api/ai/train‑epoch` | Performs a training step or an entire epoch and returns the training metrics【858205439123634†L1378-L1429】. |\n| `POST /api/ai/predict` | Uses the Bull/Bear agent to predict a bull or bear trend for the given symbol and returns the result【858205439123634†L1431-L1461】. |\n| `POST /api/ai/extract‑features` and `POST /api/ai/backtest` | Extracts features from data or performs a backtest and returns results【858205439123634†L1472-L1481】. |\n\n## Analysis endpoints (`/api/analysis`)\n\nThese routes use `AnalysisController` and perform various technical or sentiment analyses on market data. Each route accepts a JSON body and returns results:\n\n| Path (Method) | Description / operation |\n| --- | --- |\n| `POST /api/analysis/signals` | Analyses technical signals【858205439123634†L1482-L1486】. |\n| `POST /api/analysis/smc` | Performs Market Structure (SMC) analysis【858205439123634†L1487-L1490】. |\n| `POST /api/analysis/elliott` | Analyses Elliott waves【858205439123634†L1491-L1494】. |\n| `POST /api/analysis/harmonic` | Detects harmonic patterns【858205439123634†L1495-L1497】. |\n| `POST /api/analysis/sentiment` | Performs sentiment analysis on text or news【858205439123634†L1499-L1501】. |\n| `POST /api/analysis/whale` | Analyses whale activity in the market【858205439123634†L1503-L1505】. |\n\n## Trading and portfolio endpoints (`/api/trading` and `/api/trade`)\n\nThe `TradingController` is used to provide trading-related data:\n\n| Path (Method) | Description |\n| --- | --- |\n| `GET /api/trading/portfolio` | Returns the user’s portfolio status (currencies and balances)【858205439123634†L1507-L1510】. |\n| `GET /api/trading/market/:symbol` | Provides market data and a brief analysis for the specified symbol【858205439123634†L1512-L1514】. |\n| `POST /api/trade/execute` | Executes a test order in the demo environment【858205439123634†L1516-L1519】. |\n| `GET /api/trade/open‑positions` | Returns current open positions【858205439123634†L1521-L1523】. |\n\n## Market data and general services\n\nBesides internal controllers, this project uses external data services. Important routes include:\n\n| Path (Method) | Description |\n| --- | --- |\n| `GET /api/market‑data/prices` | Returns current market prices (from the primary source)【858205439123634†L1525-L1528】. |\n| `GET /api/market/overview` | Extracts a general overview of the crypto market (total market cap, volume, BTC dominance etc.) from the primary source【858205439123634†L1120-L1132】. |\n| `POST /api/sentiment/analyze` | Performs sentiment analysis on provided text【858205439123634†L1142-L1163】. |\n| `GET /api/data‑pipeline/status` | Reports the status of the data pipeline, data quality and the emergency mode【858205439123634†L1175-L1186】. |\n| `POST /api/data‑pipeline/emergency‑mode` | Activates or deactivates emergency mode for data ingestion【858205439123634†L1197-L1213】. |\n| `POST /api/data‑pipeline/add‑symbol` | Adds a new symbol to the watchlist【858205439123634†L1222-L1237】. |\n\n### Additional market routes\n\nThe `server.ts` file also defines many other routes such as `/api/market/real‑prices`, `/api/market/coingecko‑prices`, `/api/market/cryptocompare‑prices`, `/api/market/prices`, `/api/market/history` and several test routes for market data (not listed here due to length). Their behaviour is similar: retrieving prices from different providers and offering market history.\n\n## System and health routes\n\nThe server provides health information, system status and configuration at the following paths:\n\n| Path (Method) | Description |\n| --- | --- |\n| `GET /status/health` | Performs a simple health check for load balancers【858205439123634†L858-L865】. |\n| `GET /metrics` | Returns Prometheus metrics【858205439123634†L863-L865】. |\n| `GET /api/health` | Reports overall system health, including Hugging Face services, Redis and data quality【858205439123634†L870-L973】. |\n| `GET /api/system/health` | Uses `SystemController` to return database, Redis and primary data source health in JSON【858205439123634†L1531-L1534】. |\n| `GET /api/system/config` | Returns system configuration (data mode, demo mode, data sources etc.)【858205439123634†L1535-L1537】. |\n\n## Alert and notification routing\n\nThe alert module (`AlertService`) provides a set of routes to manage alerts:\n\n| Path (Method) | Description |\n| --- | --- |\n| `POST /api/alerts` | Creates a new alert【858205439123634†L1576-L1586】. |\n| `GET /api/alerts` | Retrieves current alerts from the Hugging Face service【858205439123634†L1596-L1621】. |\n| `DELETE /api/alerts/:id` | Deletes an alert with the specified id【858205439123634†L1627-L1641】. |\n| `GET /api/alerts/analytics` | Returns statistics related to alerts【858205439123634†L1652-L1667】. |\n| `POST /api/alerts/:id/success` and `POST /api/alerts/:id/false‑positive` | Records whether an alert was successful or a false positive【858205439123634†L1670-L1699】. |\n\n## Hugging Face and support routes\n\n* `GET /api/hf/status` checks the connection to the Hugging Face data engine and WebSocket health【858205439123634†L1118-L1133】.\n* `GET /api/hf/validate` performs a connection test without using cache to check token validity and response time.\n* `POST /api/binance/toggle‑testnet` and `GET /api/binance/health` always return a 503 error because the project runs in Hugging Face-only mode【858205439123634†L1249-L1264】.\n\n## Other useful routes\n\n* **Unified proxy (`/api/proxy/...`)**: Using `UnifiedProxyService`, external requests (e.g. Binance) are tunneled through the server.\n* **Telegram management (`/api/telegram/config`)**: Returns the configuration of the Telegram bot and a preview of the chat ID【858205439123634†L1702-L1716】.\n* **Provider routes (`/api/providers/*`)**: Returns the status and categories of data providers (e.g. different exchanges).\n* **Logs and rate limits (`/api/logs`, `/api/rate‑limits`)**: Used to view recent logs and API rate limit status.\n\n## WebSocket routes\n\nThe server starts a **WebSocket** on the path `/ws`. The classes `FuturesWebSocketChannel` and `ScoreStreamGateway` in the `src/ws` folder manage real‑time communications (for example sending position updates or signal scores). The `handleConnection` method in `FuturesWebSocketChannel` determines how messages are received and sent. The WebSocket is provided on the same HTTP port at `/ws`.\n\n## Conclusion\n\nThe routing architecture of this project is based on **a central file (`server.ts`)** that defines all routes and delegates them to appropriate controllers. This design makes it easy to observe and follow the routes, although the file’s large size makes it somewhat challenging to read. The only route loaded from a separate file is the `dataSourceRouter`, which exposes data source configuration【858205439123634†L819-L823】. All other routes directly call methods in the **AI, analysis, trading, system, alert and market services** controllers, offering a wide range of features—from neural network training to alert management and health reporting."}